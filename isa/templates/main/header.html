<!DOCTYPE html>
<html
  lang="{{ session_language }}"
  dir="{% if is_rtl %}rtl{% else %}ltr{% endif %}"
>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>{% if title %}ISA - {{ title }}{% else %}ISA Tool{% endif %}</title>

    <!-- Bootstrap CSS -->
    {% if is_rtl %}
    <link
      rel="stylesheet"
      href="https://tools-static.wmflabs.org/cdnjs/ajax/libs/bootstrap-v4-rtl/4.3.1-0/css/bootstrap-rtl.css"
    />
    {% else %}
    <link
      rel="stylesheet"
      href="https://tools-static.wmflabs.org/cdnjs/ajax/libs/twitter-bootstrap/4.3.1/css/bootstrap.min.css"
    />
    {% endif %}

    <!-- Font Awesome -->
    <link
      rel="stylesheet"
      href="https://tools-static.wmflabs.org/cdnjs/ajax/libs/font-awesome/5.8.2/css/all.css"
    />

    <!-- Custom CSS -->
    <link
      rel="stylesheet"
      href="{{url_for('static', filename='css/components/header.css')}}"
    />
    {% if is_rtl %}
    <link
      rel="stylesheet"
      href="{{url_for('static', filename='css/components/header-rtl.css')}}"
    />
    {% endif %}

    <!-- Favicon -->
    <link
      rel="icon"
      href="{{ url_for('static', filename='icons/favicon.svg') }}"
      type="image/svg+xml"
    />
    <link
      rel="shortcut icon"
      type="image/png"
      href="https://upload.wikimedia.org/wikipedia/commons/4/4c/ISA_Structured_Data_logo.png"
    />
    <link
      rel="apple-touch-icon"
      href="https://upload.wikimedia.org/wikipedia/commons/4/4c/ISA_Structured_Data_logo.png"
    />
    {{ styles|default('', true)|safe }}
  </head>
  <body class="{% if is_rtl %}rtl{% endif %}">
    <!-- Top Announcement Bar -->
    <div class="announcement-bar">
      <div class="container">
        <div class="announcement-content">
          <span class="announcement-badge">NEW</span>
          <span class="announcement-text"
            >{{ _('New campaigns available! Join now to earn points') }}</span
          >
          <a
            href="{{url_for('campaigns.getCampaigns')}}"
            class="announcement-link"
            >{{ _('View Campaigns') }} â†’</a
          >
        </div>
        <button class="announcement-close">&times;</button>
      </div>
    </div>

    <!-- Main Navigation -->
    <nav class="navbar navbar-expand-lg navbar-light">
      <div class="container">
        <!-- Logo and Brand -->
        <a class="navbar-brand" href="{{url_for('main.home')}}">
          <div class="brand-container">
            <img
              class="logo-icon"
              src="{{ url_for('static', filename='ISA-Structured-Data-logo_landscape_white.png') }}"
              alt="{{ _('ISA Structured Data logo') }}"
              loading="lazy"
            />
            <div class="brand-text">
              <span class="brand-name">ISA</span>
              <span class="brand-subtitle"
                >{{ _('Structured Data Tool') }}</span
              >
            </div>
          </div>
        </a>

        <!-- Mobile Menu Toggle -->
        <button
          class="navbar-toggler"
          type="button"
          data-toggle="collapse"
          data-target="#mainNav"
        >
          <span class="navbar-toggler-icon"></span>
        </button>

        <!-- Navigation Links -->
        <div class="collapse navbar-collapse" id="mainNav">
          <ul class="navbar-nav mr-auto">
            <li class="nav-item">
              <a class="nav-link" href="{{url_for('main.home')}}">
                <i class="fas fa-home nav-icon"></i>
                <span>{{ _('Home') }}</span>
              </a>
            </li>
            <li class="nav-item dropdown">
              <a
                class="nav-link dropdown-toggle"
                href="#"
                role="button"
                data-toggle="dropdown"
              >
                <i class="fas fa-bell nav-icon"></i>
                <span>{{ _('Campaigns') }}</span>
                {% if current_user and current_user.participating_campaigns %}
                <span class="badge badge-pill badge-primary badge-notification"
                  >{{ current_user.participating_campaigns|length }}</span
                >
                {% endif %}
              </a>
              <div class="dropdown-menu">
                <a
                  class="dropdown-item"
                  href="{{url_for('campaigns.getCampaigns')}}"
                >
                  <i class="fas fa-list mr-2"></i>{{ _('All Campaigns') }}
                </a>
                {% if username != 'Guest' and username != None %}
                <a
                  class="dropdown-item"
                  href="{{url_for('users.getMyCampaigns', username=username)}}"
                >
                  <i class="fas fa-star mr-2"></i>{{ _('My Campaigns') }}
                </a>
                <div class="dropdown-divider"></div>
                <a
                  class="dropdown-item"
                  href="{{url_for('campaigns.CreateCampaign')}}"
                >
                  <i class="fas fa-plus-circle mr-2"></i>{{ _('Create Campaign')
                  }}
                </a>
                {% endif %}
              </div>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="{{url_for('main.show_statistics')}}">
                <i class="fas fa-chart-line nav-icon"></i>
                <span>{{ _('Statistics') }}</span>
              </a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="{{url_for('main.help')}}">
                <i class="fas fa-question-circle nav-icon"></i>
                <span>{{ _('Help') }}</span>
              </a>
            </li>
          </ul>

          <!-- Right Side Actions -->
          <div class="navbar-actions">
            <!-- Search Box (Optional)
            <div class="search-box">
              <input
                type="text"
                placeholder="{{ _('Search campaigns...') }}"
                class="search-input"
              />
              <button class="search-btn">
                <i class="fas fa-search"></i>
              </button>
            </div> -->

            <!-- Language Selector -->
            <div class="language-selector dropdown">
              <button
                class="language-btn dropdown-toggle"
                type="button"
                data-toggle="dropdown"
              >
                <i class="fas fa-globe"></i>
                <span class="language-code"
                  >{{ session_language[:2]|upper }}</span
                >
              </button>
              <div class="dropdown-menu dropdown-menu-right">
                {% for language in languages %}
                <a
                  class="dropdown-item language-option {% if session_language==language %}active{% endif %}"
                  href="#"
                  data-lang="{{ language }}"
                >
                  {{ language }}
                </a>
                {% endfor %}
              </div>
            </div>

            <!-- User Profile -->
            {% if username %}
            <div class="user-profile dropdown">
              <button
                class="user-btn dropdown-toggle"
                type="button"
                data-toggle="dropdown"
              >
                <div class="user-avatar">
                  <i class="fas fa-user"></i>
                </div>
                <div class="user-info">
                  <span class="username">{{ username }}</span>
                  {% if current_user and current_user.points %}
                  <span class="user-points"
                    >{{ current_user.points }} {{ _('points') }}</span
                  >
                  {% endif %}
                </div>
              </button>
              <div class="dropdown-menu dropdown-menu-right">
                <div class="dropdown-header">
                  <strong>{{ username }}</strong>
                  {% if current_user and current_user.points %}
                  <div class="points-display">
                    {{ current_user.points }} {{ _('points') }}
                  </div>
                  {% endif %}
                </div>
                <div class="dropdown-divider"></div>
                <a
                  class="dropdown-item"
                  href="{{url_for('users.userSettings')}}"
                >
                  <i class="fas fa-cog mr-2"></i>{{ _('Settings') }}
                </a>
                <a
                  class="dropdown-item"
                  href="{{url_for('users.getMyCampaigns', username=username)}}"
                >
                  <i class="fas fa-bell mr-2"></i>{{ _('My Campaigns') }}
                </a>
                <a
                  class="dropdown-item"
                  href="{{url_for('users.myContributions', username=username)}}"
                >
                  <i class="fas fa-history mr-2"></i>{{ _('My Contributions') }}
                </a>
                <div class="dropdown-divider"></div>
                <a class="dropdown-item" href="{{url_for('users.logout')}}">
                  <i class="fas fa-sign-out-alt mr-2"></i>{{ _('Logout') }}
                </a>
              </div>
            </div>
            {% else %}
            <div class="auth-buttons">
              <a
                href="{{url_for('users.login')}}"
                class="btn btn-outline-primary btn-login"
              >
                <i class="fab fa-wikipedia-w mr-2"></i>{{ _('Login') }}
              </a>
              <a
                href="https://commons.wikimedia.org/wiki/Special:CreateAccount"
                target="_blank"
                class="btn btn-primary btn-signup"
              >
                {{ _('Sign Up') }}
              </a>
            </div>
            {% endif %}
          </div>
        </div>
      </div>
    </nav>

    <!-- Flash Messages -->
    {% with messages = get_flashed_messages(with_categories=true) %} {% if
    messages %}
    <div class="flash-messages-container">
      {% for category, message in messages %}
      <div
        class="alert alert-{{ category }} alert-dismissible fade show"
        role="alert"
      >
        <div class="container">
          {{ message }}
          <button
            type="button"
            class="close"
            data-dismiss="alert"
            aria-label="Close"
          >
            <span aria-hidden="true">&times;</span>
          </button>
        </div>
      </div>
      {% endfor %}
    </div>
    {% endif %} {% endwith %}

    <!-- Footer will be included in layout.html or here if needed -->
  </body>
</html>
